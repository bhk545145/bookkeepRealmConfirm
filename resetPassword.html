<!DOCTYPE html>
<html>
<head>
  <script src="https://s3.amazonaws.com/stitch-sdks/js/bundles/4.7.0/stitch.js"></script>
  <script>
  function parseQueryString(query) {
      var vars = query.split('&');
      var query_string = {};
      for (var i = 0; i < vars.length; i++) {
          var pair = vars[i].split('=');
          var key = decodeURIComponent(pair[0]);
          var value = decodeURIComponent(pair[1]);
          query_string[key] = value;
      }
      return query_string;
  }

  window.onload = function() {
      var query = window.location.search.substring(1);
      var qs = parseQueryString(query);
      
      document.getElementById('resetPassword').onclick = function() {
          var newPassword = document.getElementById('newPassword').value;
          var app = stitch.Stitch.initializeAppClient('bookkeepwithaigc-hioop');
          app.emailPasswordAuth.resetPassword(qs.token, qs.tokenId, newPassword)
              .then(() => document.getElementById('status').innerText = 'Password has been reset!')
              .catch(err => document.getElementById('status').innerText = 'Failed to reset password. Error: ' + err);
      };
  }
  </script>
</head>
<body>
  <input type="password" id="newPassword" placeholder="New Password">
  <button id="resetPassword">Reset Password</button>
  <p id="status"></p>
</body>
</html>